{"ast":null,"code":"\"use strict\";Object.defineProperty(exports,\"__esModule\",{value:true});exports.applyNameSettingsGradle=applyNameSettingsGradle;exports.getName=getName;exports.sanitizeNameForGradle=sanitizeNameForGradle;exports.withNameSettingsGradle=exports.withName=void 0;function _androidPlugins(){var data=require(\"../plugins/android-plugins\");_androidPlugins=function _androidPlugins(){return data;};return data;}function _warnings(){var data=require(\"../utils/warnings\");_warnings=function _warnings(){return data;};return data;}function _Resources(){var data=require(\"./Resources\");_Resources=function _Resources(){return data;};return data;}function _Strings(){var data=require(\"./Strings\");_Strings=function _Strings(){return data;};return data;}/**\n * Sanitize a name, this should be used for files and gradle names.\n * - `[/, \\, :, <, >, \", ?, *, |]` are not allowed\n * https://docs.gradle.org/4.2/release-notes.html#path-separator-characters-in-names-are-deprecated\n *\n * @param name\n */function sanitizeNameForGradle(name){// Remove escape characters which are valid in XML names but not in gradle.\nname=name.replace(/[\\n\\r\\t]/g,'');// Gradle disallows these:\n// The project name 'My-Special ðŸ˜ƒ Co/ol_Project' must not contain any of the following characters: [/, \\, :, <, >, \", ?, *, |]. Set the 'rootProject.name' or adjust the 'include' statement (see https://docs.gradle.org/6.2/dsl/org.gradle.api.initialization.Settings.html#org.gradle.api.initialization.Settings:include(java.lang.String[]) for more details).\nreturn name.replace(/(\\/|\\\\|:|<|>|\"|\\?|\\*|\\|)/g,'');}var withName=(0,_androidPlugins().createStringsXmlPlugin)(applyNameFromConfig,'withName');exports.withName=withName;var withNameSettingsGradle=function withNameSettingsGradle(config){return(0,_androidPlugins().withSettingsGradle)(config,function(config){if(config.modResults.language==='groovy'){config.modResults.contents=applyNameSettingsGradle(config,config.modResults.contents);}else{(0,_warnings().addWarningAndroid)('name',\"Cannot automatically configure settings.gradle if it's not groovy\");}return config;});};exports.withNameSettingsGradle=withNameSettingsGradle;function getName(config){return typeof config.name==='string'?config.name:null;}function applyNameFromConfig(config,stringsJSON){var name=getName(config);if(name){return(0,_Strings().setStringItem)([(0,_Resources().buildResourceItem)({name:'app_name',value:name})],stringsJSON);}return(0,_Strings().removeStringItem)('app_name',stringsJSON);}/**\n * Regex a name change -- fragile.\n *\n * @param config\n * @param settingsGradle\n */function applyNameSettingsGradle(config,settingsGradle){var _getName;var name=sanitizeNameForGradle((_getName=getName(config))!==null&&_getName!==void 0?_getName:'');// Select rootProject.name = '***' and replace the contents between the quotes.\nreturn settingsGradle.replace(/rootProject.name\\s?=\\s?([\"'])(?:(?=(\\\\?))\\2.)*?\\1/g,\"rootProject.name = '\".concat(name.replace(/'/g,\"\\\\'\"),\"'\"));}","map":{"version":3,"sources":["../../src/android/Name.ts"],"names":["name","withName","withNameSettingsGradle","config","applyNameSettingsGradle","getName","value","sanitizeNameForGradle","settingsGradle"],"mappings":"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","sourcesContent":["import { ExpoConfig } from '@expo/config-types';\n\nimport { ConfigPlugin } from '../Plugin.types';\nimport { createStringsXmlPlugin, withSettingsGradle } from '../plugins/android-plugins';\nimport { addWarningAndroid } from '../utils/warnings';\nimport { buildResourceItem, ResourceXML } from './Resources';\nimport { removeStringItem, setStringItem } from './Strings';\n\n/**\n * Sanitize a name, this should be used for files and gradle names.\n * - `[/, \\, :, <, >, \", ?, *, |]` are not allowed\n * https://docs.gradle.org/4.2/release-notes.html#path-separator-characters-in-names-are-deprecated\n *\n * @param name\n */\nexport function sanitizeNameForGradle(name: string): string {\n  // Remove escape characters which are valid in XML names but not in gradle.\n  name = name.replace(/[\\n\\r\\t]/g, '');\n\n  // Gradle disallows these:\n  // The project name 'My-Special ðŸ˜ƒ Co/ol_Project' must not contain any of the following characters: [/, \\, :, <, >, \", ?, *, |]. Set the 'rootProject.name' or adjust the 'include' statement (see https://docs.gradle.org/6.2/dsl/org.gradle.api.initialization.Settings.html#org.gradle.api.initialization.Settings:include(java.lang.String[]) for more details).\n  return name.replace(/(\\/|\\\\|:|<|>|\"|\\?|\\*|\\|)/g, '');\n}\n\nexport const withName = createStringsXmlPlugin(applyNameFromConfig, 'withName');\n\nexport const withNameSettingsGradle: ConfigPlugin = config => {\n  return withSettingsGradle(config, config => {\n    if (config.modResults.language === 'groovy') {\n      config.modResults.contents = applyNameSettingsGradle(config, config.modResults.contents);\n    } else {\n      addWarningAndroid(\n        'name',\n        `Cannot automatically configure settings.gradle if it's not groovy`\n      );\n    }\n    return config;\n  });\n};\n\nexport function getName(config: Pick<ExpoConfig, 'name'>) {\n  return typeof config.name === 'string' ? config.name : null;\n}\n\nfunction applyNameFromConfig(\n  config: Pick<ExpoConfig, 'name'>,\n  stringsJSON: ResourceXML\n): ResourceXML {\n  const name = getName(config);\n  if (name) {\n    return setStringItem([buildResourceItem({ name: 'app_name', value: name })], stringsJSON);\n  }\n  return removeStringItem('app_name', stringsJSON);\n}\n\n/**\n * Regex a name change -- fragile.\n *\n * @param config\n * @param settingsGradle\n */\nexport function applyNameSettingsGradle(config: Pick<ExpoConfig, 'name'>, settingsGradle: string) {\n  const name = sanitizeNameForGradle(getName(config) ?? '');\n\n  // Select rootProject.name = '***' and replace the contents between the quotes.\n  return settingsGradle.replace(\n    /rootProject.name\\s?=\\s?([\"'])(?:(?=(\\\\?))\\2.)*?\\1/g,\n    `rootProject.name = '${name.replace(/'/g, \"\\\\'\")}'`\n  );\n}\n"]},"metadata":{},"sourceType":"script"}