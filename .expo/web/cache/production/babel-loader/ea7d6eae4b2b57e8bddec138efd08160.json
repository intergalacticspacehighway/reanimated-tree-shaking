{"ast":null,"code":"import{cond,sub,divide,multiply,sqrt,add,block,set,exp,sin,cos,eq,or,neq,and,lessThan,greaterThan,proc,min,abs}from'../base';import AnimatedValue from'../core/InternalAnimatedValue';var MAX_STEPS_MS=64;function spring(clock,state,config){var lastTime=cond(state.time,state.time,clock);var deltaTime=min(sub(clock,lastTime),MAX_STEPS_MS);var c=config.damping;var m=config.mass;var k=config.stiffness;var v0=multiply(-1,state.velocity);var x0=sub(config.toValue,state.position);var zeta=divide(c,multiply(2,sqrt(multiply(k,m))));// damping ratio\nvar omega0=sqrt(divide(k,m));// undamped angular frequency of the oscillator (rad/ms)\nvar omega1=multiply(omega0,sqrt(sub(1,multiply(zeta,zeta))));// exponential decay\nvar t=divide(deltaTime,1000);// in seconds\nvar sin1=sin(multiply(omega1,t));var cos1=cos(multiply(omega1,t));// under damped\nvar underDampedEnvelope=exp(multiply(-1,zeta,omega0,t));var underDampedFrag1=multiply(underDampedEnvelope,add(multiply(sin1,divide(add(v0,multiply(zeta,omega0,x0)),omega1)),multiply(x0,cos1)));var underDampedPosition=sub(config.toValue,underDampedFrag1);// This looks crazy -- it's actually just the derivative of the oscillation function\nvar underDampedVelocity=sub(multiply(zeta,omega0,underDampedFrag1),multiply(underDampedEnvelope,sub(multiply(cos1,add(v0,multiply(zeta,omega0,x0))),multiply(omega1,x0,sin1))));// critically damped\nvar criticallyDampedEnvelope=exp(multiply(-1,omega0,t));var criticallyDampedPosition=sub(config.toValue,multiply(criticallyDampedEnvelope,add(x0,multiply(add(v0,multiply(omega0,x0)),t))));var criticallyDampedVelocity=multiply(criticallyDampedEnvelope,add(multiply(v0,sub(multiply(t,omega0),1)),multiply(t,x0,omega0,omega0)));// conditions for stopping the spring animations\nvar prevPosition=state.prevPosition?state.prevPosition:new AnimatedValue(0);var isOvershooting=cond(and(config.overshootClamping,neq(config.stiffness,0)),cond(lessThan(prevPosition,config.toValue),greaterThan(state.position,config.toValue),lessThan(state.position,config.toValue)));var isVelocity=lessThan(abs(state.velocity),config.restSpeedThreshold);var isDisplacement=or(eq(config.stiffness,0),lessThan(abs(sub(config.toValue,state.position)),config.restDisplacementThreshold));return block([set(prevPosition,state.position),cond(lessThan(zeta,1),[set(state.position,underDampedPosition),set(state.velocity,underDampedVelocity)],[set(state.position,criticallyDampedPosition),set(state.velocity,criticallyDampedVelocity)]),set(state.time,clock),cond(or(isOvershooting,and(isVelocity,isDisplacement)),[cond(neq(config.stiffness,0),[set(state.velocity,0),set(state.position,config.toValue)]),set(state.finished,1)])]);}var procSpring=proc(function(finished,velocity,position,time,prevPosition,toValue,damping,mass,stiffness,overshootClamping,restSpeedThreshold,restDisplacementThreshold,clock){return spring(clock,{finished:finished,velocity:velocity,position:position,time:time,prevPosition:prevPosition},{toValue:toValue,damping:damping,mass:mass,stiffness:stiffness,overshootClamping:overshootClamping,restDisplacementThreshold:restDisplacementThreshold,restSpeedThreshold:restSpeedThreshold});});export default function springAnimation(clock,_ref,_ref2){var finished=_ref.finished,velocity=_ref.velocity,position=_ref.position,time=_ref.time,prevPosition=_ref.prevPosition;var toValue=_ref2.toValue,damping=_ref2.damping,mass=_ref2.mass,stiffness=_ref2.stiffness,overshootClamping=_ref2.overshootClamping,restDisplacementThreshold=_ref2.restDisplacementThreshold,restSpeedThreshold=_ref2.restSpeedThreshold;return procSpring(finished,velocity,position,time,prevPosition,toValue,damping,mass,stiffness,overshootClamping,restSpeedThreshold,restDisplacementThreshold,clock);}","map":{"version":3,"names":["cond","sub","divide","multiply","sqrt","add","block","set","exp","sin","cos","eq","or","neq","and","lessThan","greaterThan","proc","min","abs","AnimatedValue","MAX_STEPS_MS","spring","clock","state","config","lastTime","time","deltaTime","c","damping","m","mass","k","stiffness","v0","velocity","x0","toValue","position","zeta","omega0","omega1","t","sin1","cos1","underDampedEnvelope","underDampedFrag1","underDampedPosition","underDampedVelocity","criticallyDampedEnvelope","criticallyDampedPosition","criticallyDampedVelocity","prevPosition","isOvershooting","overshootClamping","isVelocity","restSpeedThreshold","isDisplacement","restDisplacementThreshold","finished","procSpring","springAnimation","_ref","_ref2"],"sources":["/Users/fernandorojo/Developer/messing/rea-tree/node_modules/react-native-reanimated/lib/reanimated1/animations/spring.js"],"sourcesContent":["import { cond, sub, divide, multiply, sqrt, add, block, set, exp, sin, cos, eq, or, neq, and, lessThan, greaterThan, proc, min, abs } from '../base';\nimport AnimatedValue from '../core/InternalAnimatedValue';\nvar MAX_STEPS_MS = 64;\n\nfunction spring(clock, state, config) {\n  var lastTime = cond(state.time, state.time, clock);\n  var deltaTime = min(sub(clock, lastTime), MAX_STEPS_MS);\n  var c = config.damping;\n  var m = config.mass;\n  var k = config.stiffness;\n  var v0 = multiply(-1, state.velocity);\n  var x0 = sub(config.toValue, state.position);\n  var zeta = divide(c, multiply(2, sqrt(multiply(k, m)))); // damping ratio\n\n  var omega0 = sqrt(divide(k, m)); // undamped angular frequency of the oscillator (rad/ms)\n\n  var omega1 = multiply(omega0, sqrt(sub(1, multiply(zeta, zeta)))); // exponential decay\n\n  var t = divide(deltaTime, 1000); // in seconds\n\n  var sin1 = sin(multiply(omega1, t));\n  var cos1 = cos(multiply(omega1, t)); // under damped\n\n  var underDampedEnvelope = exp(multiply(-1, zeta, omega0, t));\n  var underDampedFrag1 = multiply(underDampedEnvelope, add(multiply(sin1, divide(add(v0, multiply(zeta, omega0, x0)), omega1)), multiply(x0, cos1)));\n  var underDampedPosition = sub(config.toValue, underDampedFrag1); // This looks crazy -- it's actually just the derivative of the oscillation function\n\n  var underDampedVelocity = sub(multiply(zeta, omega0, underDampedFrag1), multiply(underDampedEnvelope, sub(multiply(cos1, add(v0, multiply(zeta, omega0, x0))), multiply(omega1, x0, sin1)))); // critically damped\n\n  var criticallyDampedEnvelope = exp(multiply(-1, omega0, t));\n  var criticallyDampedPosition = sub(config.toValue, multiply(criticallyDampedEnvelope, add(x0, multiply(add(v0, multiply(omega0, x0)), t))));\n  var criticallyDampedVelocity = multiply(criticallyDampedEnvelope, add(multiply(v0, sub(multiply(t, omega0), 1)), multiply(t, x0, omega0, omega0))); // conditions for stopping the spring animations\n\n  var prevPosition = state.prevPosition ? state.prevPosition : new AnimatedValue(0);\n  var isOvershooting = cond(and(config.overshootClamping, neq(config.stiffness, 0)), cond(lessThan(prevPosition, config.toValue), greaterThan(state.position, config.toValue), lessThan(state.position, config.toValue)));\n  var isVelocity = lessThan(abs(state.velocity), config.restSpeedThreshold);\n  var isDisplacement = or(eq(config.stiffness, 0), lessThan(abs(sub(config.toValue, state.position)), config.restDisplacementThreshold));\n  return block([set(prevPosition, state.position), cond(lessThan(zeta, 1), [set(state.position, underDampedPosition), set(state.velocity, underDampedVelocity)], [set(state.position, criticallyDampedPosition), set(state.velocity, criticallyDampedVelocity)]), set(state.time, clock), cond(or(isOvershooting, and(isVelocity, isDisplacement)), [cond(neq(config.stiffness, 0), [set(state.velocity, 0), set(state.position, config.toValue)]), set(state.finished, 1)])]);\n}\n\nvar procSpring = proc(function (finished, velocity, position, time, prevPosition, toValue, damping, mass, stiffness, overshootClamping, restSpeedThreshold, restDisplacementThreshold, clock) {\n  return spring(clock, {\n    finished: finished,\n    velocity: velocity,\n    position: position,\n    time: time,\n    prevPosition: prevPosition\n  }, {\n    toValue: toValue,\n    damping: damping,\n    mass: mass,\n    stiffness: stiffness,\n    overshootClamping: overshootClamping,\n    restDisplacementThreshold: restDisplacementThreshold,\n    restSpeedThreshold: restSpeedThreshold\n  });\n});\nexport default function springAnimation(clock, _ref, _ref2) {\n  var finished = _ref.finished,\n      velocity = _ref.velocity,\n      position = _ref.position,\n      time = _ref.time,\n      prevPosition = _ref.prevPosition;\n  var toValue = _ref2.toValue,\n      damping = _ref2.damping,\n      mass = _ref2.mass,\n      stiffness = _ref2.stiffness,\n      overshootClamping = _ref2.overshootClamping,\n      restDisplacementThreshold = _ref2.restDisplacementThreshold,\n      restSpeedThreshold = _ref2.restSpeedThreshold;\n  return procSpring(finished, velocity, position, time, prevPosition, toValue, damping, mass, stiffness, overshootClamping, restSpeedThreshold, restDisplacementThreshold, clock);\n}"],"mappings":"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"},"metadata":{},"sourceType":"module"}