{"ast":null,"code":"import _slicedToArray from\"@babel/runtime/helpers/slicedToArray\";import _toConsumableArray from\"@babel/runtime/helpers/toConsumableArray\";import _classCallCheck from\"@babel/runtime/helpers/classCallCheck\";import _createClass from\"@babel/runtime/helpers/createClass\";var MapperRegistry=function(){function MapperRegistry(module){_classCallCheck(this,MapperRegistry);this.sortedMappers=[];this.mappers=new Map();this.updatedSinceLastExecute=false;this._module=module;}_createClass(MapperRegistry,[{key:\"startMapper\",value:function startMapper(mapper){this.mappers.set(mapper.id,mapper);this.updatedSinceLastExecute=true;return mapper.id;}},{key:\"stopMapper\",value:function stopMapper(id){this.mappers[\"delete\"](id);this.updatedSinceLastExecute=true;}},{key:\"execute\",value:function execute(){if(this.updatedSinceLastExecute){this.updateOrder();this.updatedSinceLastExecute=false;}for(var i=0,len=this.sortedMappers.length;i<len;++i){var mapper=this.sortedMappers[i];if(mapper.dirty){mapper.execute();}}}},{key:\"updateOrder\",value:function updateOrder(){var nodes=_toConsumableArray(this.mappers.values()).map(function(mapper){return new Node(mapper);});var mappersById={};this.mappers.forEach(function(mapper){mappersById[mapper.id]=mapper;});for(var i=0,nodesLen=nodes.length;i<nodesLen;++i){var node=nodes[i];if(node.mapper.outputs.length===0){continue;}for(var j=0;j<nodesLen;++j){var restNode=nodes[j];if(i===j||restNode.mapper.inputs.length===0){continue;}for(var outi=0,outputsLen=node.mapper.outputs.length;outi<outputsLen;++outi){for(var resti=0,restLen=restNode.mapper.inputs.length;resti<restLen;++resti){if(node.mapper.outputs[outi]._id===restNode.mapper.inputs[resti]._id){node.children.push(restNode);}}}}}var post={};var postCounter=1;var dfs=function dfs(node){var index=nodes.indexOf(node);if(index===-1){return;}++postCounter;nodes.splice(index,1);if(node.children.length===0&&nodes.length>0){post[node.mapper.id]=postCounter++;dfs(nodes[0]);return;}for(var _i=0,len=node.children.length;_i<len;++_i){dfs(node.children[_i]);}post[node.mapper.id]=postCounter++;};while(nodes.length){dfs(nodes[0]);}var postArray=Object.keys(post).map(function(key){var num=parseInt(key);return[num,post[num]];});postArray.sort(function(a,b){return b[1]-a[1];});this.sortedMappers=[];for(var _i2=0,len=postArray.length;_i2<len;++_i2){var _postArray$_i=_slicedToArray(postArray[_i2],1),id=_postArray$_i[0];this.sortedMappers.push(mappersById[id]);}}},{key:\"needRunOnRender\",get:function get(){return this.updatedSinceLastExecute;}}]);return MapperRegistry;}();export{MapperRegistry as default};var Node=_createClass(function Node(mapper){var children=arguments.length>1&&arguments[1]!==undefined?arguments[1]:[];_classCallCheck(this,Node);this.mapper=mapper;this.children=children;});","map":{"version":3,"names":["_slicedToArray","_toConsumableArray","_classCallCheck","_createClass","MapperRegistry","module","sortedMappers","mappers","Map","updatedSinceLastExecute","_module","key","value","startMapper","mapper","set","id","stopMapper","execute","updateOrder","i","len","length","dirty","nodes","values","map","Node","mappersById","forEach","nodesLen","node","outputs","j","restNode","inputs","outi","outputsLen","resti","restLen","_id","children","push","post","postCounter","dfs","index","indexOf","splice","_i","postArray","Object","keys","num","parseInt","sort","a","b","_i2","_postArray$_i","get","default","arguments","undefined"],"sources":["/Users/fernandorojo/Developer/messing/rea-tree/node_modules/react-native-reanimated/lib/reanimated2/js-reanimated/MapperRegistry.js"],"sourcesContent":["import _slicedToArray from\"@babel/runtime/helpers/slicedToArray\";import _toConsumableArray from\"@babel/runtime/helpers/toConsumableArray\";import _classCallCheck from\"@babel/runtime/helpers/classCallCheck\";import _createClass from\"@babel/runtime/helpers/createClass\";var MapperRegistry=function(){function MapperRegistry(module){_classCallCheck(this,MapperRegistry);this.sortedMappers=[];this.mappers=new Map();this.updatedSinceLastExecute=false;this._module=module;}_createClass(MapperRegistry,[{key:\"startMapper\",value:function startMapper(mapper){this.mappers.set(mapper.id,mapper);this.updatedSinceLastExecute=true;return mapper.id;}},{key:\"stopMapper\",value:function stopMapper(id){this.mappers.delete(id);this.updatedSinceLastExecute=true;}},{key:\"execute\",value:function execute(){if(this.updatedSinceLastExecute){this.updateOrder();this.updatedSinceLastExecute=false;}for(var i=0,len=this.sortedMappers.length;i<len;++i){var mapper=this.sortedMappers[i];if(mapper.dirty){mapper.execute();}}}},{key:\"updateOrder\",value:function updateOrder(){var nodes=_toConsumableArray(this.mappers.values()).map(function(mapper){return new Node(mapper);});var mappersById={};this.mappers.forEach(function(mapper){mappersById[mapper.id]=mapper;});for(var i=0,nodesLen=nodes.length;i<nodesLen;++i){var node=nodes[i];if(node.mapper.outputs.length===0){continue;}for(var j=0;j<nodesLen;++j){var restNode=nodes[j];if(i===j||restNode.mapper.inputs.length===0){continue;}for(var outi=0,outputsLen=node.mapper.outputs.length;outi<outputsLen;++outi){for(var resti=0,restLen=restNode.mapper.inputs.length;resti<restLen;++resti){if(node.mapper.outputs[outi]._id===restNode.mapper.inputs[resti]._id){node.children.push(restNode);}}}}}var post={};var postCounter=1;var dfs=function dfs(node){var index=nodes.indexOf(node);if(index===-1){return;}++postCounter;nodes.splice(index,1);if(node.children.length===0&&nodes.length>0){post[node.mapper.id]=postCounter++;dfs(nodes[0]);return;}for(var _i=0,len=node.children.length;_i<len;++_i){dfs(node.children[_i]);}post[node.mapper.id]=postCounter++;};while(nodes.length){dfs(nodes[0]);}var postArray=Object.keys(post).map(function(key){var num=parseInt(key);return[num,post[num]];});postArray.sort(function(a,b){return b[1]-a[1];});this.sortedMappers=[];for(var _i2=0,len=postArray.length;_i2<len;++_i2){var _postArray$_i=_slicedToArray(postArray[_i2],1),id=_postArray$_i[0];this.sortedMappers.push(mappersById[id]);}}},{key:\"needRunOnRender\",get:function get(){return this.updatedSinceLastExecute;}}]);return MapperRegistry;}();export{MapperRegistry as default};var Node=_createClass(function Node(mapper){var children=arguments.length>1&&arguments[1]!==undefined?arguments[1]:[];_classCallCheck(this,Node);this.mapper=mapper;this.children=children;});"],"mappings":"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"},"metadata":{},"sourceType":"module"}