{"ast":null,"code":"import _slicedToArray from\"/Users/fernandorojo/Developer/messing/rea-tree/node_modules/next/dist/compiled/@babel/runtime/helpers/esm/slicedToArray\";import _toConsumableArray from\"/Users/fernandorojo/Developer/messing/rea-tree/node_modules/next/dist/compiled/@babel/runtime/helpers/esm/toConsumableArray\";import _classCallCheck from\"/Users/fernandorojo/Developer/messing/rea-tree/node_modules/next/dist/compiled/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/fernandorojo/Developer/messing/rea-tree/node_modules/next/dist/compiled/@babel/runtime/helpers/esm/createClass\";var MapperRegistry=/*#__PURE__*/function(){function MapperRegistry(module){_classCallCheck(this,MapperRegistry);this.sortedMappers=[];this.mappers=new Map();this.updatedSinceLastExecute=false;this._module=module;}_createClass(MapperRegistry,[{key:\"startMapper\",value:function startMapper(mapper){this.mappers.set(mapper.id,mapper);this.updatedSinceLastExecute=true;return mapper.id;}},{key:\"stopMapper\",value:function stopMapper(id){this.mappers[\"delete\"](id);this.updatedSinceLastExecute=true;}},{key:\"execute\",value:function execute(){if(this.updatedSinceLastExecute){this.updateOrder();this.updatedSinceLastExecute=false;}for(var i=0,len=this.sortedMappers.length;i<len;++i){var mapper=this.sortedMappers[i];if(mapper.dirty){mapper.execute();}}}},{key:\"updateOrder\",value:function updateOrder(){var nodes=_toConsumableArray(this.mappers.values()).map(function(mapper){return new Node(mapper);});var mappersById={};this.mappers.forEach(function(mapper){mappersById[mapper.id]=mapper;});// create a graph from array of nodes\nfor(var i=0,nodesLen=nodes.length;i<nodesLen;++i){var node=nodes[i];if(node.mapper.outputs.length===0){continue;}for(var j=0;j<nodesLen;++j){var restNode=nodes[j];if(i===j||restNode.mapper.inputs.length===0){continue;}for(var outi=0,outputsLen=node.mapper.outputs.length;outi<outputsLen;++outi){for(var resti=0,restLen=restNode.mapper.inputs.length;resti<restLen;++resti){if(node.mapper.outputs[outi]._id===restNode.mapper.inputs[resti]._id){node.children.push(restNode);}}}}}var post={};var postCounter=1;var dfs=function dfs(node){var index=nodes.indexOf(node);if(index===-1){// this node has already been handled\nreturn;}++postCounter;nodes.splice(index,1);if(node.children.length===0&&nodes.length>0){post[node.mapper.id]=postCounter++;dfs(nodes[0]);return;}for(var _i=0,len=node.children.length;_i<len;++_i){dfs(node.children[_i]);}post[node.mapper.id]=postCounter++;};while(nodes.length){dfs(nodes[0]);}var postArray=Object.keys(post).map(function(key){var num=parseInt(key);return[num,post[num]];});postArray.sort(function(a,b){return b[1]-a[1];});// clear sorted mappers\nthis.sortedMappers=[];for(var _i2=0,len=postArray.length;_i2<len;++_i2){var _postArray$_i=_slicedToArray(postArray[_i2],1),id=_postArray$_i[0];this.sortedMappers.push(mappersById[id]);}}},{key:\"needRunOnRender\",get:function get(){return this.updatedSinceLastExecute;}}]);return MapperRegistry;}();export{MapperRegistry as default};var Node=function Node(mapper){var children=arguments.length>1&&arguments[1]!==undefined?arguments[1]:[];_classCallCheck(this,Node);this.mapper=mapper;this.children=children;};","map":{"version":3,"names":["_slicedToArray","_toConsumableArray","_classCallCheck","_createClass","MapperRegistry","module","sortedMappers","mappers","Map","updatedSinceLastExecute","_module","key","value","startMapper","mapper","set","id","stopMapper","execute","updateOrder","i","len","length","dirty","nodes","values","map","Node","mappersById","forEach","nodesLen","node","outputs","j","restNode","inputs","outi","outputsLen","resti","restLen","_id","children","push","post","postCounter","dfs","index","indexOf","splice","_i","postArray","Object","keys","num","parseInt","sort","a","b","_i2","_postArray$_i","get","default","arguments","undefined"],"sources":["/Users/fernandorojo/Developer/messing/rea-tree/node_modules/react-native-reanimated/lib/reanimated2/js-reanimated/MapperRegistry.js"],"sourcesContent":["import _slicedToArray from \"/Users/fernandorojo/Developer/messing/rea-tree/node_modules/next/dist/compiled/@babel/runtime/helpers/esm/slicedToArray\";\nimport _toConsumableArray from \"/Users/fernandorojo/Developer/messing/rea-tree/node_modules/next/dist/compiled/@babel/runtime/helpers/esm/toConsumableArray\";\nimport _classCallCheck from \"/Users/fernandorojo/Developer/messing/rea-tree/node_modules/next/dist/compiled/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/fernandorojo/Developer/messing/rea-tree/node_modules/next/dist/compiled/@babel/runtime/helpers/esm/createClass\";\n\nvar MapperRegistry = /*#__PURE__*/function () {\n  function MapperRegistry(module) {\n    _classCallCheck(this, MapperRegistry);\n\n    this.sortedMappers = [];\n    this.mappers = new Map();\n    this.updatedSinceLastExecute = false;\n    this._module = module;\n  }\n\n  _createClass(MapperRegistry, [{\n    key: \"startMapper\",\n    value: function startMapper(mapper) {\n      this.mappers.set(mapper.id, mapper);\n      this.updatedSinceLastExecute = true;\n      return mapper.id;\n    }\n  }, {\n    key: \"stopMapper\",\n    value: function stopMapper(id) {\n      this.mappers[\"delete\"](id);\n      this.updatedSinceLastExecute = true;\n    }\n  }, {\n    key: \"execute\",\n    value: function execute() {\n      if (this.updatedSinceLastExecute) {\n        this.updateOrder();\n        this.updatedSinceLastExecute = false;\n      }\n\n      for (var i = 0, len = this.sortedMappers.length; i < len; ++i) {\n        var mapper = this.sortedMappers[i];\n\n        if (mapper.dirty) {\n          mapper.execute();\n        }\n      }\n    }\n  }, {\n    key: \"updateOrder\",\n    value: function updateOrder() {\n      var nodes = _toConsumableArray(this.mappers.values()).map(function (mapper) {\n        return new Node(mapper);\n      });\n\n      var mappersById = {};\n      this.mappers.forEach(function (mapper) {\n        mappersById[mapper.id] = mapper;\n      }); // create a graph from array of nodes\n\n      for (var i = 0, nodesLen = nodes.length; i < nodesLen; ++i) {\n        var node = nodes[i];\n\n        if (node.mapper.outputs.length === 0) {\n          continue;\n        }\n\n        for (var j = 0; j < nodesLen; ++j) {\n          var restNode = nodes[j];\n\n          if (i === j || restNode.mapper.inputs.length === 0) {\n            continue;\n          }\n\n          for (var outi = 0, outputsLen = node.mapper.outputs.length; outi < outputsLen; ++outi) {\n            for (var resti = 0, restLen = restNode.mapper.inputs.length; resti < restLen; ++resti) {\n              if (node.mapper.outputs[outi]._id === restNode.mapper.inputs[resti]._id) {\n                node.children.push(restNode);\n              }\n            }\n          }\n        }\n      }\n\n      var post = {};\n      var postCounter = 1;\n\n      var dfs = function dfs(node) {\n        var index = nodes.indexOf(node);\n\n        if (index === -1) {\n          // this node has already been handled\n          return;\n        }\n\n        ++postCounter;\n        nodes.splice(index, 1);\n\n        if (node.children.length === 0 && nodes.length > 0) {\n          post[node.mapper.id] = postCounter++;\n          dfs(nodes[0]);\n          return;\n        }\n\n        for (var _i = 0, len = node.children.length; _i < len; ++_i) {\n          dfs(node.children[_i]);\n        }\n\n        post[node.mapper.id] = postCounter++;\n      };\n\n      while (nodes.length) {\n        dfs(nodes[0]);\n      }\n\n      var postArray = Object.keys(post).map(function (key) {\n        var num = parseInt(key);\n        return [num, post[num]];\n      });\n      postArray.sort(function (a, b) {\n        return b[1] - a[1];\n      }); // clear sorted mappers\n\n      this.sortedMappers = [];\n\n      for (var _i2 = 0, len = postArray.length; _i2 < len; ++_i2) {\n        var _postArray$_i = _slicedToArray(postArray[_i2], 1),\n            id = _postArray$_i[0];\n\n        this.sortedMappers.push(mappersById[id]);\n      }\n    }\n  }, {\n    key: \"needRunOnRender\",\n    get: function get() {\n      return this.updatedSinceLastExecute;\n    }\n  }]);\n\n  return MapperRegistry;\n}();\n\nexport { MapperRegistry as default };\n\nvar Node = function Node(mapper) {\n  var children = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : [];\n\n  _classCallCheck(this, Node);\n\n  this.mapper = mapper;\n  this.children = children;\n};"],"mappings":"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"},"metadata":{},"sourceType":"module"}