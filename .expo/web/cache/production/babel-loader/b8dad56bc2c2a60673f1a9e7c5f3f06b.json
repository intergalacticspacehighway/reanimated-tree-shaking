{"ast":null,"code":"\"use strict\";var _regeneratorRuntime=require(\"/Users/fernandorojo/Developer/messing/rea-tree/node_modules/next/dist/compiled/@babel/runtime/regenerator\");var _asyncToGenerator=require(\"/Users/fernandorojo/Developer/messing/rea-tree/node_modules/next/dist/compiled/@babel/runtime/helpers/asyncToGenerator\");var _slicedToArray=require(\"/Users/fernandorojo/Developer/messing/rea-tree/node_modules/next/dist/compiled/@babel/runtime/helpers/slicedToArray\");Object.defineProperty(exports,\"__esModule\",{value:true});exports.applyPermissions=applyPermissions;exports.createPermissionsPlugin=createPermissionsPlugin;function _debug(){var data=_interopRequireDefault(require(\"debug\"));_debug=function _debug(){return data;};return data;}function _iosPlugins(){var data=require(\"../plugins/ios-plugins\");_iosPlugins=function _iosPlugins(){return data;};return data;}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{\"default\":obj};}var debug=(0,_debug()[\"default\"])('expo:config-plugins:ios:permissions');function applyPermissions(defaults,permissions,infoPlist){var entries=Object.entries(defaults);if(entries.length===0){debug(\"No defaults provided: \".concat(JSON.stringify(permissions)));}for(var _i=0,_entries=entries;_i<_entries.length;_i++){var _entries$_i=_slicedToArray(_entries[_i],2),permission=_entries$_i[0],description=_entries$_i[1];if(permissions[permission]===false){debug(\"Deleting \\\"\".concat(permission,\"\\\"\"));delete infoPlist[permission];}else{infoPlist[permission]=permissions[permission]||infoPlist[permission]||description;debug(\"Setting \\\"\".concat(permission,\"\\\" to \\\"\").concat(infoPlist[permission],\"\\\"\"));}}return infoPlist;}/**\n * Helper method for creating mods to apply default permissions.\n *\n * @param action\n */function createPermissionsPlugin(defaults,name){var withIosPermissions=function withIosPermissions(config,permissions){return(0,_iosPlugins().withInfoPlist)(config,/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(config){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:config.modResults=applyPermissions(defaults,permissions,config.modResults);return _context.abrupt(\"return\",config);case 2:case\"end\":return _context.stop();}}},_callee);}));return function(_x){return _ref.apply(this,arguments);};}());};if(name){Object.defineProperty(withIosPermissions,'name',{value:name});}return withIosPermissions;}","map":{"version":3,"sources":["../../src/ios/Permissions.ts"],"names":["debug","entries","Object","JSON","permissions","infoPlist","permission","withIosPermissions","config","applyPermissions","value","name"],"mappings":"+lBAAA,QAAA,CAAA,MAAA,EAAA,CAAA,GAAA,CAAA,IAAA,CAAA,sBAAA,CAAA,OAAA,CAAA,OAAA,CAAA,CAAA,CAAA,MAAA,CAAA,iBAAA,CAAA,MAAA,CAAA,IAAA,CAAA,CAAA,CAAA,MAAA,CAAA,IAAA,CAAA,CAGA,QAAA,CAAA,WAAA,EAAA,CAAA,GAAA,CAAA,IAAA,CAAA,OAAA,CAAA,wBAAA,CAAA,CAAA,WAAA,CAAA,sBAAA,CAAA,MAAA,CAAA,IAAA,CAAA,CAAA,CAAA,MAAA,CAAA,IAAA,CAAA,C,qFAGA,GAAMA,CAAAA,KAAK,CAAG,CAAA,EAAA,MAAA,aAAA,EAAd,qCAAc,CAAd,CAEO,QAAA,CAAA,gBAAA,CAAA,QAAA,CAAA,WAAA,CAAA,SAAA,CAIM,CACX,GAAMC,CAAAA,OAAO,CAAGC,MAAM,CAANA,OAAAA,CAAhB,QAAgBA,CAAhB,CACA,GAAID,OAAO,CAAPA,MAAAA,GAAJ,CAAA,CAA0B,CACxBD,KAAK,iCAA0BG,IAAI,CAAJA,SAAAA,CAA/BH,WAA+BG,CAA1B,EAALH,CACD,CACD,sBAAA,OAAA,yBAAiD,CAA5C,+CAAM,UAAN,gBAAL,WAAK,gBACH,GAAII,WAAW,CAAXA,UAAW,CAAXA,GAAJ,KAAA,CAAuC,CACrCJ,KAAK,sBAALA,UAAK,OAALA,CACA,MAAOK,CAAAA,SAAS,CAAhB,UAAgB,CAAhB,CAFF,CAAA,IAGO,CACLA,SAAS,CAATA,UAAS,CAATA,CAAwBD,WAAW,CAAXA,UAAW,CAAXA,EAA2BC,SAAS,CAApCD,UAAoC,CAApCA,EAAxBC,WAAAA,CACAL,KAAK,qBAAaM,UAAb,oBAAgCD,SAAS,CAA9CL,UAA8C,CAAzC,OAALA,CACD,CACF,CACD,MAAA,CAAA,SAAA,CACD,CAED;AACA;AACA;AACA;AACA,GACO,QAAA,CAAA,uBAAA,CAAA,QAAA,CAAA,IAAA,CAE8B,CACnC,GAAMO,CAAAA,kBAAoF,CAAG,QAAvFA,CAAAA,kBAAuF,CAAA,MAAA,CAAA,WAAA,QAI3F,CAAA,EAAA,WAAA,GAAA,aAAA,EAAA,MAAA,0FAAsB,iBAAA,MAAA,kHACpBC,MAAM,CAANA,UAAAA,CAAoBC,gBAAgB,CAAA,QAAA,CAAA,WAAA,CAAwBD,MAAM,CAAlEA,UAAoC,CAApCA,CADoB,gCAEpB,MAFoB,wDAAtB,+DAJ2F,EAA7F,CAQA,GAAA,IAAA,CAAU,CACRN,MAAM,CAANA,cAAAA,CAAAA,kBAAAA,CAAAA,MAAAA,CAAkD,CAChDQ,KAAK,CAAEC,IADyC,CAAlDT,EAGD,CACD,MAAA,CAAA,kBAAA,CACD","sourcesContent":["import Debug from 'debug';\n\nimport { ConfigPlugin } from '../Plugin.types';\nimport { withInfoPlist } from '../plugins/ios-plugins';\nimport { InfoPlist } from './IosConfig.types';\n\nconst debug = Debug('expo:config-plugins:ios:permissions');\n\nexport function applyPermissions<Defaults extends Record<string, string> = Record<string, string>>(\n  defaults: Defaults,\n  permissions: Partial<Record<keyof Defaults, string | false>>,\n  infoPlist: InfoPlist\n): InfoPlist {\n  const entries = Object.entries(defaults);\n  if (entries.length === 0) {\n    debug(`No defaults provided: ${JSON.stringify(permissions)}`);\n  }\n  for (const [permission, description] of entries) {\n    if (permissions[permission] === false) {\n      debug(`Deleting \"${permission}\"`);\n      delete infoPlist[permission];\n    } else {\n      infoPlist[permission] = permissions[permission] || infoPlist[permission] || description;\n      debug(`Setting \"${permission}\" to \"${infoPlist[permission]}\"`);\n    }\n  }\n  return infoPlist;\n}\n\n/**\n * Helper method for creating mods to apply default permissions.\n *\n * @param action\n */\nexport function createPermissionsPlugin<\n  Defaults extends Record<string, string> = Record<string, string>\n>(defaults: Defaults, name?: string) {\n  const withIosPermissions: ConfigPlugin<Record<keyof Defaults, string | undefined | false>> = (\n    config,\n    permissions\n  ) =>\n    withInfoPlist(config, async config => {\n      config.modResults = applyPermissions(defaults, permissions, config.modResults);\n      return config;\n    });\n  if (name) {\n    Object.defineProperty(withIosPermissions, 'name', {\n      value: name,\n    });\n  }\n  return withIosPermissions;\n}\n"]},"metadata":{},"sourceType":"script"}