{"ast":null,"code":"\"use strict\";var _regeneratorRuntime=require(\"/Users/fernandorojo/Developer/messing/rea-tree/node_modules/next/dist/compiled/@babel/runtime/regenerator\");var _asyncToGenerator=require(\"/Users/fernandorojo/Developer/messing/rea-tree/node_modules/next/dist/compiled/@babel/runtime/helpers/asyncToGenerator\");Object.defineProperty(exports,\"__esModule\",{value:true});exports.configureEasBuildAsync=configureEasBuildAsync;exports.getEasBuildGradlePath=getEasBuildGradlePath;exports.isEasBuildGradleConfiguredAsync=isEasBuildGradleConfiguredAsync;function _fs(){var data=_interopRequireDefault(require(\"fs\"));_fs=function _fs(){return data;};return data;}function _path(){var data=_interopRequireDefault(require(\"path\"));_path=function _path(){return data;};return data;}function _EasBuildGradleScript(){var data=_interopRequireDefault(require(\"./EasBuildGradleScript\"));_EasBuildGradleScript=function _EasBuildGradleScript(){return data;};return data;}function Paths(){var data=_interopRequireWildcard(require(\"./Paths\"));Paths=function Paths(){return data;};return data;}function _getRequireWildcardCache(nodeInterop){if(typeof WeakMap!==\"function\")return null;var cacheBabelInterop=new WeakMap();var cacheNodeInterop=new WeakMap();return(_getRequireWildcardCache=function _getRequireWildcardCache(nodeInterop){return nodeInterop?cacheNodeInterop:cacheBabelInterop;})(nodeInterop);}function _interopRequireWildcard(obj,nodeInterop){if(!nodeInterop&&obj&&obj.__esModule){return obj;}if(obj===null||typeof obj!==\"object\"&&typeof obj!==\"function\"){return{\"default\":obj};}var cache=_getRequireWildcardCache(nodeInterop);if(cache&&cache.has(obj)){return cache.get(obj);}var newObj={};var hasPropertyDescriptor=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var key in obj){if(key!==\"default\"&&Object.prototype.hasOwnProperty.call(obj,key)){var desc=hasPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):null;if(desc&&(desc.get||desc.set)){Object.defineProperty(newObj,key,desc);}else{newObj[key]=obj[key];}}}newObj[\"default\"]=obj;if(cache){cache.set(obj,newObj);}return newObj;}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{\"default\":obj};}var APPLY_EAS_GRADLE='apply from: \"./eas-build.gradle\"';function hasApplyLine(content,applyLine){return content.replace(/\\r\\n/g,'\\n').split('\\n')// Check for both single and double quotes\n.some(function(line){return line===applyLine||line===applyLine.replace(/\"/g,\"'\");});}function getEasBuildGradlePath(projectRoot){return _path()[\"default\"].join(projectRoot,'android','app','eas-build.gradle');}function configureEasBuildAsync(_x){return _configureEasBuildAsync.apply(this,arguments);}function _configureEasBuildAsync(){_configureEasBuildAsync=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(projectRoot){var buildGradlePath,easGradlePath,buildGradleContent,hasEasGradleApply;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:buildGradlePath=Paths().getAppBuildGradleFilePath(projectRoot);easGradlePath=getEasBuildGradlePath(projectRoot);_context.next=4;return _fs()[\"default\"].promises.writeFile(easGradlePath,_EasBuildGradleScript()[\"default\"]);case 4:_context.next=6;return _fs()[\"default\"].promises.readFile(_path()[\"default\"].join(buildGradlePath),'utf8');case 6:buildGradleContent=_context.sent;hasEasGradleApply=hasApplyLine(buildGradleContent,APPLY_EAS_GRADLE);if(hasEasGradleApply){_context.next=11;break;}_context.next=11;return _fs()[\"default\"].promises.writeFile(buildGradlePath,\"\".concat(buildGradleContent.trim(),\"\\n\").concat(APPLY_EAS_GRADLE,\"\\n\"));case 11:case\"end\":return _context.stop();}}},_callee);}));return _configureEasBuildAsync.apply(this,arguments);}function isEasBuildGradleConfiguredAsync(_x2){return _isEasBuildGradleConfiguredAsync.apply(this,arguments);}function _isEasBuildGradleConfiguredAsync(){_isEasBuildGradleConfiguredAsync=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(projectRoot){var buildGradlePath,easGradlePath,hasEasGradleFile,buildGradleContent,hasEasGradleApply;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:buildGradlePath=Paths().getAppBuildGradleFilePath(projectRoot);easGradlePath=getEasBuildGradlePath(projectRoot);_context2.next=4;return _fs()[\"default\"].existsSync(easGradlePath);case 4:hasEasGradleFile=_context2.sent;_context2.next=7;return _fs()[\"default\"].promises.readFile(_path()[\"default\"].join(buildGradlePath),'utf8');case 7:buildGradleContent=_context2.sent;hasEasGradleApply=hasApplyLine(buildGradleContent,APPLY_EAS_GRADLE);return _context2.abrupt(\"return\",hasEasGradleApply&&hasEasGradleFile);case 10:case\"end\":return _context2.stop();}}},_callee2);}));return _isEasBuildGradleConfiguredAsync.apply(this,arguments);}","map":{"version":3,"sources":["../../src/android/EasBuild.ts"],"names":["APPLY_EAS_GRADLE","line","applyLine","path","buildGradlePath","Paths","easGradlePath","getEasBuildGradlePath","fs","gradleScript","buildGradleContent","hasEasGradleApply","hasApplyLine","hasEasGradleFile"],"mappings":"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","sourcesContent":["import fs from 'fs';\nimport path from 'path';\n\nimport gradleScript from './EasBuildGradleScript';\nimport * as Paths from './Paths';\n\nconst APPLY_EAS_GRADLE = 'apply from: \"./eas-build.gradle\"';\n\nfunction hasApplyLine(content: string, applyLine: string): boolean {\n  return (\n    content\n      .replace(/\\r\\n/g, '\\n')\n      .split('\\n')\n      // Check for both single and double quotes\n      .some(line => line === applyLine || line === applyLine.replace(/\"/g, \"'\"))\n  );\n}\n\nexport function getEasBuildGradlePath(projectRoot: string): string {\n  return path.join(projectRoot, 'android', 'app', 'eas-build.gradle');\n}\n\nexport async function configureEasBuildAsync(projectRoot: string): Promise<void> {\n  const buildGradlePath = Paths.getAppBuildGradleFilePath(projectRoot);\n  const easGradlePath = getEasBuildGradlePath(projectRoot);\n\n  await fs.promises.writeFile(easGradlePath, gradleScript);\n\n  const buildGradleContent = await fs.promises.readFile(path.join(buildGradlePath), 'utf8');\n\n  const hasEasGradleApply = hasApplyLine(buildGradleContent, APPLY_EAS_GRADLE);\n\n  if (!hasEasGradleApply) {\n    await fs.promises.writeFile(\n      buildGradlePath,\n      `${buildGradleContent.trim()}\\n${APPLY_EAS_GRADLE}\\n`\n    );\n  }\n}\n\nexport async function isEasBuildGradleConfiguredAsync(projectRoot: string): Promise<boolean> {\n  const buildGradlePath = Paths.getAppBuildGradleFilePath(projectRoot);\n  const easGradlePath = getEasBuildGradlePath(projectRoot);\n\n  const hasEasGradleFile = await fs.existsSync(easGradlePath);\n\n  const buildGradleContent = await fs.promises.readFile(path.join(buildGradlePath), 'utf8');\n  const hasEasGradleApply = hasApplyLine(buildGradleContent, APPLY_EAS_GRADLE);\n\n  return hasEasGradleApply && hasEasGradleFile;\n}\n"]},"metadata":{},"sourceType":"script"}